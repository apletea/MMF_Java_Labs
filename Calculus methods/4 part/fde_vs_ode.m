clear;
clc;
a0=0;
b0=1;
g0=1;
a1=3;
b1=1.5;
g1=6.75;
a=0;
b=0.5;
t0=0;
t1=8;
opts=odeset('AbsTol',1.e-6,'InitialStep',1.e-6);
u=@(x) 1/3*(x+1).^3;
f=@(x,y)[y(2);2/(x+1)*y(2)+3*y(1)-(x+1)^3];
y0=[t0,(g0-a0*t0)/b0];
[x,Z1]=ode45(f,[a,b],y0,opts);
y0=[t1,(g0-a0*t1)/b0];
[x,Z2]=ode45(f,[a,b],y0,opts);

z12=Z1(end,2);
z11=Z1(end,1);
z22=Z2(end,2);
z21=Z2(end,1);
c=(g1-a1*z11-b1*z12)/(a1*(z21-z11)+b1*(z22-z12));
U=(1-c)*Z1(:,1)+c*Z2(:,1);
plot(x,u(x),'.-',x,U,'o')
legend('exact','prst');
xlabel('x');
ylabel('u');
